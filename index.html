<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>SHUCHA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="hello, world!">
<meta property="og:type" content="website">
<meta property="og:title" content="SHUCHA">
<meta property="og:url" content="http:&#x2F;&#x2F;yarn.run&#x2F;">
<meta property="og:site_name" content="SHUCHA">
<meta property="og:description" content="hello, world!">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="SHUCHA" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">SHUCHA</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yarn.run"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-转载-如何写出无法维护的代码" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/18/%E8%BD%AC%E8%BD%BD-%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E6%97%A0%E6%B3%95%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81/" class="article-date">
  <time datetime="2019-12-18T08:47:53.000Z" itemprop="datePublished">2019-12-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/18/%E8%BD%AC%E8%BD%BD-%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E6%97%A0%E6%B3%95%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81/">转载 如何写出无法维护的代码</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文链接: <a href="https://coolshell.cn/articles/4758.html" target="_blank" rel="noopener">酷壳-如何写出无法维护的代码</a></p>
<h4 id="程序命名"><a href="#程序命名" class="headerlink" title="程序命名"></a>程序命名</h4><ul>
<li><strong>容易输入的名字</strong>。比如：Fred，asdf</li>
<li><strong>单字母的变量名</strong>。比如：a,b,c, x,y,z（陈皓注：如果不够用，可以考虑a1,a2,a3,a4,….）</li>
<li><strong>有创意地拼写错误</strong>。比如：SetPintleOpening， SetPintalClosing。这样可以让人很难搜索代码。</li>
<li><strong>抽象</strong>。比如：ProcessData, DoIt, GetData… 抽象到就跟什么都没说一样。</li>
<li><strong>缩写</strong>。比如：WTF，RTFSC …… （陈皓注：使用拼音缩写也同样给力，比如： BT，TMD，TJJTDS）</li>
<li><strong>随机大写字母</strong>。比如：gEtnuMbER..</li>
<li><strong>重用命名</strong>。在内嵌的语句块中使用相同的变量名有奇效。</li>
<li><strong>使用重音字母</strong>。比如：int  ínt（注：第二个 ínt不是int）</li>
<li><strong>使用下划线</strong>。比如：<em>, _</em>, ___。</li>
<li><strong>使用不同的语言</strong>。比如混用英语，德语，或是中文拼音。</li>
<li><strong>使用字符命名</strong>。比如：slash, asterix, comma…</li>
<li><strong>使用无关的单词</strong>。比如：god, superman, iloveu….</li>
<li><strong>混淆l和1</strong>。字母l和数字1有时候是看不出来的。</li>
</ul>
<h4 id="伪装欺诈"><a href="#伪装欺诈" class="headerlink" title="伪装欺诈"></a>伪装欺诈</h4><ul>
<li><strong>把注释和代码交织在一起</strong>。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;array_len; j+ =<span class="number">8</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    total += <span class="built_in">array</span>[j+<span class="number">0</span> ];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    total += <span class="built_in">array</span>[j+<span class="number">1</span> ];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    total += <span class="built_in">array</span>[j+<span class="number">2</span> ]; <span class="comment">/* Main body of</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment">    total += array[j+3]; * loop is unrolled</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment">    total += array[j+4]; * for greater speed.</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="comment">    total += array[j+5]; */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    total += <span class="built_in">array</span>[j+<span class="number">6</span> ];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    total += <span class="built_in">array</span>[j+<span class="number">7</span> ];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ul>
<li><p><strong>隐藏宏定义</strong>。如：#define a=b a=0-b，当人们看到a=b时，谁也想不到那是一个宏。</p>
</li>
<li><p><strong>换行</strong>。如下所示，下面的示例使用搜索xy_z变得困难。</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> local_var xy\</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">_z <span class="comment">// local_var OK</span></span></pre></td></tr></table></figure>

<ul>
<li><p><strong>代码和显示不一致</strong>。比如，你的界面显示叫postal code，但是代码里确叫 zipcode.</p>
</li>
<li><p><strong>隐藏全局变量</strong>。把使用全局变量以函数参数的方式传递给函数，这样可以让人觉得那个变量不是全局变量。</p>
</li>
<li><p><strong>使用同意词</strong>。如：</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> xxx global_var <span class="comment">// in file std.h&amp;nbsp;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> xy_z xxx <span class="comment">// in file ..\other\substd.h&amp;nbsp;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> local_var xy_z <span class="comment">// in file ..\codestd\inst.h</span></span></span></pre></td></tr></table></figure>

<ul>
<li><p><strong>使用相似的变量名</strong>。如：单词相似，swimmer 和 swimner，字母相似：ilI1| 或 oO08。parselnt 和 parseInt， D0Calc 和 DOCalc。还有这一组：xy_Z, xy__z, _xy_z, _xyz, XY_Z, xY_z, Xy_z。</p>
</li>
<li><p><strong>重载函数</strong>。使用相同的函数名，但是其功能和具体实现完全没有关系。</p>
</li>
<li><p><strong>操作符重载</strong>。重载操作符可以让你的代码变得诡异，感谢CCTV，感谢C++。这个东西是可以把混乱代码提高到一种艺术的形式。比如：重载一个类的 ! 操作符，但实际功能并不是取反，让其返回一个整数。于是，如果你使用 ! ! 操作符，那么，有意思的事就发生了—— 先是调用类的重载 ! 操作符，然后把其返回的整数给 ! 成了 布尔变量，如果是 !!! 呢？呵呵。</p>
</li>
<li><p><strong>#define</strong>。看过本站那些混乱代码的文章，你都会知道宏定义和预编译对于写出不可读的代码的重大意义。不过，一个具有想像力的东西是——在头文件中使用预编译来查看这个头文件被include了几次，而被include不同的次数时，其中的函数定义完全不一样。</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DONE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> TWICE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment">// put stuff here to declare 3rd time around</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">g</span><span class="params">(<span class="keyword">char</span>* str)</span></span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DONE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">else</span> <span class="comment">// TWICE</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ONCE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="comment">// put stuff here to declare 2nd time around&lt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">g</span><span class="params">(<span class="keyword">void</span>* str)</span></span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TWICE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">else</span> <span class="comment">// ONCE</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="comment">// put stuff here to declare 1st time around</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">g</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> str)</span></span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ONCE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// ONCE</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TWICE</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// DONE</span></span></span></pre></td></tr></table></figure>

<h4 id="文档和注释"><a href="#文档和注释" class="headerlink" title="文档和注释"></a>文档和注释</h4><ul>
<li><strong>在注释中撒谎</strong>。你不用真的去撒谎，只需在改代码的时候不要更新注释就可以了。</li>
<li><strong>注释明显的东西</strong>。比如：/* add 1 to i */。（参看“<a href="https://coolshell.cn/articles/2746.html" target="_blank" rel="noopener">五种应该避免的注释</a>”）</li>
<li><strong>只注释是什么，而不是为什么</strong>。</li>
<li><strong>不要注释秘密</strong>。如果你开发一个航班系统，请你一定要保证每有一个新的航班被加入，就得要修改25个以上的位置的程序。千万别把这个事写在文档中。</li>
<li><strong>注重细节</strong>。当你设计一个很复杂的算法的时候，你一定要把所有的详细细设计都写下来，没有100页不能罢休，段落要有5级以上，段落编号要有500个以上，例如：1.2.4.6.3.13 – Display all impacts for activity where selected mitigations can apply (short pseudocode omitted). 这样，当你写代码的时候，你就可以让你的代码和文档一致，如：Act1_2_4_6_3_13()</li>
<li><strong>千万不要注释度衡单位</strong>。比如时间用的是秒还是毫秒，尺寸用的是像素还是英寸，大小是MB还是KB。等等。另外，在你的代码里，你可以混用不同的度衡单位，但也不要注释。</li>
<li><strong>Gotchas</strong>。陷阱，千万不要注释代码中的陷阱。</li>
<li><strong>在注释和文档中发泄不满</strong>。（参看本站的“<a href="https://coolshell.cn/articles/2746.html" target="_blank" rel="noopener">五种应该避免的注释</a>”）</li>
</ul>
<h4 id="程序设计"><a href="#程序设计" class="headerlink" title="程序设计"></a>程序设计</h4><ul>
<li><strong>Java Casts</strong>。Java的类型转型是天赐之物。每一次当你从Collection里取到一个object的时候，你都需要把其转回原来的类型。因些，这些转型操作会出现在N多的地方。如果你改变了类型，那么你不一定能改变所有的地方。而编译器可能能检查到，也可能检查不到。</li>
<li><strong>利用Java的冗余</strong>。比如：Bubblegum b = new Bubblegom(); 和 swimmer = swimner + 1; 注意变量间的细微差别。</li>
<li><strong>从不验证</strong>。从不验证输入的数据，从不验证函数的返回值。这样做可以向大家展示你是多么的信任公司的设备和其它程序员。</li>
<li><strong>不要封装</strong>。调用者需要知道被调用的所有的细节。</li>
<li><strong>克隆和拷贝</strong>。为了效率，你要学会使用copy + paste。你几乎都不用理解别人的代码，你就可以高效地编程了。（陈皓注：Copy + Paste出来的代码bug多得不能再多）</li>
<li><strong>巨大的listener</strong>。写一个listener，然后让你的所有的button类都使用这个listener，这样你可以在这个listener中整出一大堆if…else…语句，相当的刺激。</li>
<li><strong>使用三维数组</strong>。如果你觉得三维还不足够，你可以试试四维。</li>
<li><strong>混用</strong>。同时使用类的get/set方法和直接访问那个public变量。这样做的好处是可以极大的挫败维护人员。</li>
<li><strong>包装，包装，包装</strong>。把你所有的API都包装上6到8遍，包装深度多达4层以上。然后包装出相似的功能。</li>
<li><strong>没有秘密</strong>。把所有的成员都声明成public的。这样，你以后就很难限制其被人使用，而且这样可以和别的代码造成更多的耦合度，可以让你的代码存活得更久。</li>
<li><strong>排列和阻碍</strong>。把drawRectangle(height, width) 改成 drawRectangle(width, height)，等release了几个版本后，再把其改回去。这样维护程序的程序员们将不能很快地明白哪一个是对的。</li>
<li><strong>把变量改在名字上</strong>。例如，把setAlignment(int alignment)改成，setLeftAlignment, setRightAlignment, setCenterAlignment。</li>
<li><strong>Packratting</strong>。保留你所有的没有使用的和陈旧的变量，方法和代码。</li>
<li><strong>That’s Fina</strong>l。Final你所有的子结点的类，这样，当你做完这个项目后，没有人可以通过继承来扩展你的类。java.lang.String不也是这样吗？</li>
<li><strong>避免使用接口</strong>。在java中，BS接口，在C++中BS使用虚函数。</li>
<li><strong>避免使用layout</strong>。这样就使得我们只能使用绝对坐标。如果你的老大强制你使用layout，你可以考虑使用GridBagLayout，然后把grid坐标hard code.</li>
<li><strong>环境变量</strong>。如果你的代码需要使用环境变量。(getenv() – C++ / System.getProperty() – Java )，那么，你应该把你的类的成员的初始化使用环境变量，而不是构造函数。</li>
<li><strong>使用Magic numbe</strong>r。参看《<a href="https://coolshell.cn/articles/4576.html" target="_blank" rel="noopener">Linux一个插曲</a>》。</li>
<li><strong>使用全局变量</strong>。1）把全局变量的初始化放在不同的函数中，就算这个函数和这个变量没有任何关系，这样能够让我们的维护人员就像做侦探工作一样。2）使用全局变量可以让你的函数的参数变得少一些。</li>
<li><strong>配置文件</strong>。配置文件主要用于一些参数的初始化。在编程中，我们可以让配置文件中的参数名和实际程序中的名字不一样。</li>
<li><strong>膨胀你的类</strong>。让你的类尽可能地拥有各种臃肿和晦涩的方法。比如，你的类只实现一种可能性，但是你要提供所有可能性的方法。不要定义其它的类，把所有的功能都放在一个类中。</li>
<li><strong>使用子类</strong>。面向对象是写出无法维护代码的天赐之物。如果你有一个类有十个成为（变量和方法）你可以考虑写10个层次的继承，然后把这十个属性分别放在这十个层次中。如果可能的话，把这十个类分别放在十个不同的文件中。</li>
</ul>
<h4 id="混乱你的代码"><a href="#混乱你的代码" class="headerlink" title="混乱你的代码"></a>混乱你的代码</h4><ul>
<li><strong>使用XML</strong>。XML的强大是无人能及的。使用XML你可以把本来只要10行的代码变成100行。而且，还要逼着别人也有XML。（参看，<a href="https://coolshell.cn/articles/2504.html" target="_blank" rel="noopener">信XML得永生</a>，<a href="https://coolshell.cn/articles/3498.html" target="_blank" rel="noopener">信XML得自信</a>）</li>
<li><strong>混乱C代码</strong>。在《<a href="https://coolshell.cn/articles/933.html" target="_blank" rel="noopener">如何加密源代码</a>》中已经说过一些方法了，这里再补充一些。</li>
<li><strong>使用不同的进制</strong>。比如：10 和010不是一样的。再比如：array = new int[]{  111,  120,  013,  121,};</li>
<li><strong>尽量使用void*</strong>。然后把其转成各种类型</li>
<li><strong>使用隐式的转型</strong>。C++的构造函数可以让你神不知鬼不觉得完成转型。</li>
<li><strong>分解条件表达式</strong>。如：把 a==100分解成，a&gt;99 &amp;&amp; a&lt;101</li>
<li><strong>学会利用分号</strong>。如：if ( a );else;{  int d;  d = c;}</li>
<li><strong>间接转型</strong>。如：把double转string，写成new Double(d).toString() 而不是 Double.toString(d)</li>
<li><strong>大量使用嵌套</strong>。一个NB的程序员可以在一行代码上使用超过10层的小括号（），或是在一个函数里使用超过20层的语句嵌套{}，把嵌套的if else 转成 [? :] 也是一件很NB的事。</li>
<li><strong>使用C的变种数组</strong>。myArray[i] 可以变成*(myArray + i) 也可以变成 *(i + myArray) 其等价于 i[myArray]。再看一个函数调用的示例，函数声明：int myfunc(int q, int p) { return p%q; } 函数调用myfunc(6291, 8)[Array];</li>
<li><strong>长代码行</strong>。一行的代码越长越好。这样别人阅读时就需要来来回回的</li>
<li><strong>不要较早的return</strong>。不要使用goto，不要使用break，这样，你就需要至少5层以上的if-else来处理错误。</li>
<li><strong>不要使用{}</strong>。不要在if else使用{}，尤其是在你重量地使用if-else嵌套时，你甚至可以在其中乱缩进代码，这样一来，就算是最有经验的程序员也会踩上陷阱。</li>
<li><strong>使用宏定义</strong>。宏定义绝对是混乱C/C++代码的最佳利器。参看 <a href="https://coolshell.cn/articles/2420.html" target="_blank" rel="noopener">老手是这样教新手编程的</a>。</li>
<li><strong>琐碎的封装</strong>。比较封装一个bool类，类里面什么都做，就是一个bool.</li>
<li><strong>循环</strong>。千万不可用for(int i=0; i&lt;n; i++)使用while代替for，交换n和i，把&lt;改成&lt;=，使用 i–调整步伐 。</li>
</ul>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><ul>
<li><strong>从不测试</strong>。千万不要测试任何的出错处理，从来也不检测系统调用的返回值。</li>
<li><strong>永远不做性能测试</strong>。如果不够快就告诉用户换一个更快的机器。如果你一做测试，那么就可能会要改你的算法，甚至重设计，重新架构。</li>
<li><strong>不要写测试案例</strong>。不要做什么代码覆盖率测试，自动化测试。</li>
<li><strong>测试是懦夫行为</strong>。一个勇敢的程序员是根本不需要这一步的。太多的程序太害怕他们的老板，害怕失去工作，害怕用户抱怨，甚至被起诉。这种担心害怕直接影响了生产力。如果你对你的代码有强大的信心，那还要什么测试呢？真正的程序员是不需要测试自己的代码的。</li>
</ul>
<h4 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h4><ul>
<li><strong>你的老板什么都知道</strong>。无论你的老板有多SB，你都要严格地遵照他的旨意办事，这样一来，你会学到更多的知识如何写出无法维护的代码来的。</li>
<li><strong>颠覆Help Desk</strong>。你要确保你那满是bug的程序永远不要被维护团队知道。当用户打电话和写邮件给你的时候，你就不要理会，就算要理会，让用户重做系统或是告诉用户其帐号有问题，是标准的回答。</li>
<li><strong>闭嘴</strong>。对于一些像y2k这样的大bug，你要学会守口如瓶，不要告诉任何人，包括你的亲人好友以及公司的同事和管理层，这样当到那一天的时候，你就可以用这个bug挣钱了。</li>
<li><strong>忽悠</strong>。你会学会忽悠，就算你的代码写得很烂，你也要为其挂上GoF设计模式的标签，就算你的项目做得再烂，你也要为其挂上敏捷的标签，只有学会<a href="https://coolshell.cn/articles/3745.html" target="_blank" rel="noopener">像中国Thoughtworks的咨询师那样去忽悠</a>，你才能学会更炫更酷的方法，让整个团队和公司，甚至整个业界都开始躁动，这样才能真正为难维护的代码铺平道路。</li>
</ul>
<p>这个文档中还有很多很多，实在是太TMD强大了，大家自己去看看吧。有精力有能力的朋友不妨把其翻译成中文。</p>
<p>总之，我们的口号是——</p>
<h4 id="Write-Everywhere-Read-Nowhere"><a href="#Write-Everywhere-Read-Nowhere" class="headerlink" title="Write Everywhere, Read Nowhere"></a>Write Everywhere, Read Nowhere</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/18/%E8%BD%AC%E8%BD%BD-%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E6%97%A0%E6%B3%95%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81/" data-id="ck4e606r40008al6bdxty9knu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-前端组件-Skeleton-Screen" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/17/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6-Skeleton-Screen/" class="article-date">
  <time datetime="2019-12-17T08:29:27.000Z" itemprop="datePublished">2019-12-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/17/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6-Skeleton-Screen/">前端组件 Skeleton Screen</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>写作动力来自于知乎专栏: <a href="https://zhuanlan.zhihu.com/c_87416856" target="_blank" rel="noopener">这个控件叫什么</a> 中的 <code>这个控件叫：Skeleton Screen/加载占位图</code></p>
<p><a href="https://codepen.io/shucha/pen/oNgbRvM" target="_blank" rel="noopener">效果预览</a></p>
<p>这里主要用到的是<code>liner-gradient</code>和<code>background-position</code></p>
<p>使用<code>linear-gradient</code>生成一个渐变背景:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">linear-gradient(90deg, red 25%, yellow 37%, red 63%)</span></pre></td></tr></table></figure>

<p><img src="https://blog-image-1255951271.cos.ap-beijing.myqcloud.com/WX20191217-143917%402x.png" alt="linear-gradient(90deg, red 25%, yellow 37%, red 63%)"></p>
<p>使用红色和黄色的原因是因为颜色比较清晰方便测试，正常使用可以替换为:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(90<span class="selector-tag">deg</span>, <span class="selector-id">#f2f2f2</span> 25%, <span class="selector-id">#e6e6e6</span> 37%, <span class="selector-id">#f2f2f2</span> 63%);</span></pre></td></tr></table></figure>

<p>想了解更多<code>linear-gradient</code> 的用法? 请阅读<a href="https://www.w3cplus.com/css3/do-you-really-understand-css-linear-gradients.html" target="_blank" rel="noopener">你真的理解CSS的linear-gradient</a>， 文章详细解释了<code>linear-gradient</code>的一些工作细节并在文末提供了一个调整<code>linear-gradient</code>渐变效果的小工具, 上图出自于此。</p>
<p>将渐变容器的<code>bcakground-size</code>定义为 <code>400%, 100%</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">background-size</span>: 400% 100%;</span></pre></td></tr></table></figure>

<p>因为这个时候背景比容器大(背景宽度为 容器宽度 * 400%)，当background-position的值从100%递减到0%时，会有这样的效果：</p>
<p><img src="https://blog-image-1255951271.cos.ap-beijing.myqcloud.com/Dec-17-2019%2016-01-10.gif" alt="background-position: 100%, background-position: 0%"></p>
<p>然后通过<code>animation</code>不断播放这个动画</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@<span class="keyword">keyframes</span> loadding</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">	<span class="number">0%</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">		background-position: <span class="number">100%</span> <span class="number">50%</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">	<span class="number">100%</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">		background-position: <span class="number">0</span> <span class="number">50%</span>	</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">#demo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">	height: <span class="number">50px</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">	width: <span class="number">100%</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">	background: linear-gradient(<span class="number">90deg</span>, red <span class="number">25%</span>, yellow <span class="number">37%</span>, red <span class="number">63%</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">	background-size: <span class="number">400%</span> <span class="number">100%</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">	animation: loadding <span class="number">1.2s</span> ease infinite</span></pre></td></tr></table></figure>

<p>这样就实现了一个简单的Skeleton Screen.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/17/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6-Skeleton-Screen/" data-id="ck4e606r20004al6b4i23g4e3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6/" rel="tag">前端组件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Notification-放到React-中后产生的一些问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/15/Notification-%E6%94%BE%E5%88%B0React-%E4%B8%AD%E5%90%8E%E4%BA%A7%E7%94%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2019-12-15T10:30:49.000Z" itemprop="datePublished">2019-12-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/15/Notification-%E6%94%BE%E5%88%B0React-%E4%B8%AD%E5%90%8E%E4%BA%A7%E7%94%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">Notification 放到React 中后产生的一些问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>因为项目需要写了一个Notification 组件，<a href="https://codepen.io/shucha/pen/ZEYOQdQ" target="_blank" rel="noopener">demo</a>放在 codepen中. 但在我将它应用到React中时却出现了一些问题.</p>
<ol>
<li>旧的dom节点不会被删除，无法触发animation/transition</li>
<li>直接操作dom节点，不符合数据驱动UI的设计理念</li>
<li>它应该是一个高阶组件</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/15/Notification-%E6%94%BE%E5%88%B0React-%E4%B8%AD%E5%90%8E%E4%BA%A7%E7%94%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/" data-id="ck4e606qz0001al6bav0zhhn2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6/" rel="tag">前端组件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-firefox的锚点与chrome的锚点表现不同" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/10/firefox%E7%9A%84%E9%94%9A%E7%82%B9%E4%B8%8Echrome%E7%9A%84%E9%94%9A%E7%82%B9%E8%A1%A8%E7%8E%B0%E4%B8%8D%E5%90%8C/" class="article-date">
  <time datetime="2019-12-10T02:46:44.000Z" itemprop="datePublished">2019-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/10/firefox%E7%9A%84%E9%94%9A%E7%82%B9%E4%B8%8Echrome%E7%9A%84%E9%94%9A%E7%82%B9%E8%A1%A8%E7%8E%B0%E4%B8%8D%E5%90%8C/">firefox的锚点与chrome的锚点表现不同</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://codepen.io/shucha/pen/MWYKLJo" target="_blank" rel="noopener">效果预览</a></p>
<p>如果页面的宽度高度足够的情况下，在火狐中点击一个锚元素(<code>&lt;a&gt;</code>) 页面会定位到目标元素的位置：</p>
<p><img src="https://blog-image-1255951271.cos.ap-beijing.myqcloud.com/Dec-10-2019%2010-55-06.gif" alt="火狐"></p>
<p>chrome</p>
<p><img src="https://blog-image-1255951271.cos.ap-beijing.myqcloud.com/Dec-10-2019%2010-52-07.gif" alt="chrome"></p>
<p>有时候我们不想让页面偏移，可以将锚元素的目标设置成一个隐藏的元素并且将它定位到页面边缘。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/10/firefox%E7%9A%84%E9%94%9A%E7%82%B9%E4%B8%8Echrome%E7%9A%84%E9%94%9A%E7%82%B9%E8%A1%A8%E7%8E%B0%E4%B8%8D%E5%90%8C/" data-id="ck4e606r10003al6b08ne14vs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9/" rel="tag">浏览器兼容</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-CSS-Transition" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/07/CSS-Transition/" class="article-date">
  <time datetime="2019-12-07T12:11:02.000Z" itemprop="datePublished">2019-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/07/CSS-Transition/">Css Transition</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://codepen.io/shucha/pen/WNbQXyP" target="_blank" rel="noopener">效果预览</a></p>
<h2 id="Transition"><a href="#Transition" class="headerlink" title="Transition"></a>Transition</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Transitions/Using_CSS_transitions" target="_blank" rel="noopener">transition</a>  属性是 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-property" target="_blank" rel="noopener"><code>transition-property</code></a>，<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-duration" target="_blank" rel="noopener"><code>transition-duration</code></a>，<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-timing-function" target="_blank" rel="noopener"><code>transition-timing-function</code></a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-delay" target="_blank" rel="noopener"><code>transition-delay</code></a> 的一个<a href="https://developer.mozilla.org/en-US/docs/CSS/Shorthand_properties" target="_blank" rel="noopener">简写属性</a>。可以为一个元素在不同状态切换时定义不同的过渡效果。包括不同的伪类之间的切换，像是<code>:hover</code>, <code>:active</code> 。或者通过<code>JavaScript</code>实现的状态变化. 使用transition可以使页面操作更平滑.</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-property" target="_blank" rel="noopener"><code>transition-property</code></a></p>
<p>指定哪个或哪些 CSS 属性用于过渡。只有指定的属性才会在过渡中发生动画，其它属性仍如通常那样瞬间变化。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-duration" target="_blank" rel="noopener"><code>transition-duration</code></a></p>
<p>指定过渡的时长。或者为所有属性指定一个值，或者指定多个值，为每个属性指定不同的时长。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-timing-function" target="_blank" rel="noopener"><code>transition-timing-function</code></a></p>
<p><img src="https://developer.mozilla.org/files/3434/TF_with_output_gt_than_1.png" alt="img"><br>指定一个函数，定义属性值怎么变化。缓动函数 <em>Timing functions</em> 定义属性如何计算。多数 <a href="https://developer.mozilla.org/en-US/docs/CSS/timing-function" target="_blank" rel="noopener">timing functions</a> 由四点定义一个 bezier 曲线。也可以从 <a href="http://easings.net/" target="_blank" rel="noopener">Easing Functions Cheat Sheet</a> 选择缓动效果。</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-delay" target="_blank" rel="noopener"><code>transition-delay</code></a></p>
<p>指定延迟，即属性开始变化时与过渡开始发生时之间的时长。</p>
<p>简写语法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="attribute">transition</span>: &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="检测Transition是否完成"><a href="#检测Transition是否完成" class="headerlink" title="检测Transition是否完成"></a>检测Transition是否完成</h2><p>当过渡完成时触发一个事件，在符合标准的浏览器下，这个事件是 <code>transitionend</code>, 在 WebKit 下是 <code>webkitTransitionEnd</code>. 详情查看页面底部的兼容性表格。 <code>transitionend 事件提供两个属性</code>:</p>
<ul>
<li><p><code>propertyName</code></p>
<p>字符串，指示已完成过渡的属性。</p>
</li>
<li><p><code>elapsedTime</code></p>
<p>浮点数，指示当触发这个事件时过渡已运行的时间（秒）。这个值不受 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-delay" target="_blank" rel="noopener"><code>transition-delay</code></a> 影响。</p>
</li>
</ul>
<p>照例可以用  <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/addEventListener" target="_blank" rel="noopener"><code>element.addEventListener()</code></a> 方法来监听这个事件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">el.addEventListener(<span class="string">"transitionend"</span>, updateTransition, <span class="literal">true</span>);</span></pre></td></tr></table></figure>



<h2 id="当属性值列表长度不一致时"><a href="#当属性值列表长度不一致时" class="headerlink" title="当属性值列表长度不一致时"></a>当属性值列表长度不一致时</h2><p>以 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-property" target="_blank" rel="noopener"><code>transition-property</code></a> 的值列表长度为标准，如果某个属性值列表长度短于它的，则重复其值以长度一致， 例如:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">	<span class="attribute">transition-property</span>: opacity, left, top, height;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">	<span class="attribute">transition-duration</span>: <span class="number">3s</span>, <span class="number">5s</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>将按下面这样处理</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">	<span class="attribute">tarnsition-property</span>: opacity, left, top. height;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">	<span class="attribute">transition-duration</span>: <span class="number">3s</span>, <span class="number">5s</span>, <span class="number">3s</span>, <span class="number">5s</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>类似地，如果某个属性的值列表长于 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transition-property" target="_blank" rel="noopener"><code>transition-property</code></a> 的，将被截短。 例如:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="attribute">transition-property</span>: opacity, left;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="attribute">transition-duration</span>: <span class="number">3s</span>, <span class="number">5s</span>, <span class="number">2s</span>, <span class="number">1s</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>将按下面这样处理:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="attribute">transition-property</span>: opacity, left;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="attribute">transition-duration</span>: <span class="number">3s</span>, <span class="number">5s</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>###</p>
<h2 id="Transform"><a href="#Transform" class="headerlink" title="Transform"></a>Transform</h2><p><code>translate()</code> 变换函数通过 <code>x</code> 向量和 <code>y</code> 向量移动元素 (i.e. <code>xnew = xold + , ynew = yold +</code>). 如果 <code>y</code> 向量没有被提供，那么默认为 <code>0</code> </p>
<p><code>scale()</code> 变换函数通过 <code>x</code> 和 <code>y</code>指定一个 <strong>等比例放大缩小</strong> 操作。如果 <code>y</code> 没有被提供，那么假定为等同于 <code>x</code></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Transitions/Using_CSS_transitions" target="_blank" rel="noopener">Transition 参考文档</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/transform" target="_blank" rel="noopener">Tranform 参考文档</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/07/CSS-Transition/" data-id="ck4e606qv0000al6b01gfadu5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/transition/" rel="tag">transition</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-实现图片拖拽上传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/06/%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8B%96%E6%8B%BD%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time datetime="2019-12-06T09:10:24.000Z" itemprop="datePublished">2019-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/06/%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8B%96%E6%8B%BD%E4%B8%8A%E4%BC%A0/">实现图片拖拽上传</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://codepen.io/shucha/pen/BayNEVN" target="_blank" rel="noopener">效果预览</a></p>
<h3 id="拖拽相关的事件"><a href="#拖拽相关的事件" class="headerlink" title="拖拽相关的事件"></a>拖拽相关的事件</h3><table>
<thead>
<tr>
<th align="left">Event</th>
<th align="left">On Event Handler</th>
<th align="left">Fires when…</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>drag</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondrag" target="_blank" rel="noopener"><code>ondrag</code></a></td>
<td align="left">当拖动元素或选中的文本时触发。</td>
</tr>
<tr>
<td align="left"><code>dragend</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragend" target="_blank" rel="noopener"><code>ondragend</code></a></td>
<td align="left">当拖拽操作结束时触发 (比如松开鼠标按键或敲“Esc”键)。</td>
</tr>
<tr>
<td align="left"><code>dragenter</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragenter" target="_blank" rel="noopener"><code>ondragenter</code></a></td>
<td align="left">当拖动元素或选中的文本到一个可释放目标时触发。</td>
</tr>
<tr>
<td align="left"><code>dragexit</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragexit" target="_blank" rel="noopener"><code>ondragexit</code></a></td>
<td align="left">当元素变得不再是拖动操作的选中目标时触发。</td>
</tr>
<tr>
<td align="left"><code>dragleave</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragleave" target="_blank" rel="noopener"><code>ondragleave</code></a></td>
<td align="left">当拖动元素或选中的文本离开一个可释放目标时触发。</td>
</tr>
<tr>
<td align="left"><code>dragover</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragover" target="_blank" rel="noopener"><code>ondragover</code></a></td>
<td align="left">当元素或选中的文本被拖到一个可释放目标上时触发（每100毫秒触发一次）。</td>
</tr>
<tr>
<td align="left"><code>dragstart</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondragstart" target="_blank" rel="noopener"><code>ondragstart</code></a></td>
<td align="left">当用户开始拖动一个元素或选中的文本时触发。</td>
</tr>
<tr>
<td align="left"><code>drop</code></td>
<td align="left"><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/ondrop" target="_blank" rel="noopener"><code>ondrop</code></a></td>
<td align="left">当元素或选中的文本在可释放目标上被释放时触发。</td>
</tr>
</tbody></table>
<p><em>1: 当从操作系统向浏览器中拖动文件时，不会触发 <code>dragstart</code> 和<code>dragend</code> 事件。</em></p>
<p><em>2: 使用 <code>e.target.files</code> 来获取普通上传的文件，使用 <code>e.dataTransfer.files</code>获取拖拽上传的文件。</em></p>
<p><em>3: Event对象的preventDefault() 方法用来阻止事件的默认操作，例如当我们将文件拖拽到浏览器窗口中时，浏览器默认会在当前页打开这个文件。可以调用event.preventDefault();阻止它。还有<code>&lt;button type=&quot;submit&quot; /&gt;</code> 等。</em></p>
<h3 id="FileReader"><a href="#FileReader" class="headerlink" title="FileReader"></a>FileReader</h3><p><code>FileReader</code> 对象运行js异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容，使用 <code>File</code>或 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob" target="_blank" rel="noopener"><code>Blob</code></a> 对象指定要读取的文件或数据。</p>
<p>其中<code>File</code>对象可以是来自用户在一个<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input" target="_blank" rel="noopener"><code>Input</code></a>元素上选择文件后返回的<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileList" target="_blank" rel="noopener"><code>FileList</code></a>对象,也可以来自拖放操作生成的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/DataTransfer" target="_blank" rel="noopener"><code>DataTransfer</code></a>对象,还可以是来自在一个<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement" target="_blank" rel="noopener"><code>HTMLCanvasElement</code></a>上执行<code>mozGetAsFile()</code>方法后返回结果。</p>
<p>####事件处理</p>
<p><code>FileReader.onabort</code> 文件读取被中断.</p>
<p><code>FileReader.onerror</code> 文件读取错误</p>
<p><code>FileReader.onload</code> 文件读取完成</p>
<p><code>FileReader.onloadstart</code> 开始读取</p>
<p><code>FileReader.onloadend</code> 读取结束</p>
<p><code>Filereader.onprogress</code> 读取<code>Bold</code>对象时触发, 可以用来做进度条</p>
<p><em><code>File</code>继承自<code>Bold</code>, 因为 <code>FileReader</code> 继承自<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget" target="_blank" rel="noopener"><code>EventTarget</code></a>，所以所有这些事件也可以通过<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="noopener"><code>addEventListener</code></a>方法使用。</em></p>
<p>###本文参考文档: <a href="https://developer.mozilla.org/en-US/docs/Web/API" target="_blank" rel="noopener">MDN web docs</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yarn.run/2019/12/06/%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8B%96%E6%8B%BD%E4%B8%8A%E4%BC%A0/" data-id="ck4e606r30005al6b0i7z258m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%8B%96%E6%8B%BD/" rel="tag">文件拖拽</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/transition/" rel="tag">transition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6/" rel="tag">前端组件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%8B%96%E6%8B%BD/" rel="tag">文件拖拽</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9/" rel="tag">浏览器兼容</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/transition/" style="font-size: 10px;">transition</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6/" style="font-size: 20px;">前端组件</a> <a href="/tags/%E6%96%87%E4%BB%B6%E6%8B%96%E6%8B%BD/" style="font-size: 10px;">文件拖拽</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9/" style="font-size: 10px;">浏览器兼容</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/12/18/%E8%BD%AC%E8%BD%BD-%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E6%97%A0%E6%B3%95%E7%BB%B4%E6%8A%A4%E7%9A%84%E4%BB%A3%E7%A0%81/">转载 如何写出无法维护的代码</a>
          </li>
        
          <li>
            <a href="/2019/12/17/%E5%89%8D%E7%AB%AF%E7%BB%84%E4%BB%B6-Skeleton-Screen/">前端组件 Skeleton Screen</a>
          </li>
        
          <li>
            <a href="/2019/12/15/Notification-%E6%94%BE%E5%88%B0React-%E4%B8%AD%E5%90%8E%E4%BA%A7%E7%94%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">Notification 放到React 中后产生的一些问题</a>
          </li>
        
          <li>
            <a href="/2019/12/10/firefox%E7%9A%84%E9%94%9A%E7%82%B9%E4%B8%8Echrome%E7%9A%84%E9%94%9A%E7%82%B9%E8%A1%A8%E7%8E%B0%E4%B8%8D%E5%90%8C/">firefox的锚点与chrome的锚点表现不同</a>
          </li>
        
          <li>
            <a href="/2019/12/07/CSS-Transition/">Css Transition</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 shucha<br>
      <a href="http://www.beian.miit.gov.cn" target="_blank">鲁ICP备19063433号-1</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>